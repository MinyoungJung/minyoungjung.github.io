<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Blog &middot; Ringsterz Log
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/main.css">
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">

  
  <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_SVG"> </script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true } });
  </script>
  

  <!-- Adsense -->
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
      (adsbygoogle = window.adsbygoogle || []).push({
        google_ad_client: "ca-pub-4842709304550263",
        enable_page_level_ads: true
      });
    </script>
</head>

  <!-- Begin Jekyll SEO tag v2.6.0 -->
<title>Blog | Ringsterz Log</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Blog" />
<meta name="author" content="Minyoung Jung" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="하루를 정리하는 데일리 로그" />
<meta property="og:description" content="하루를 정리하는 데일리 로그" />
<link rel="canonical" href="http://localhost:4000/blog/" />
<meta property="og:url" content="http://localhost:4000/blog/" />
<meta property="og:site_name" content="Ringsterz Log" />
<link rel="next" href="http://localhost:4000/blog/page2" />
<script type="application/ld+json">
{"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/public/logo.png"},"name":"Minyoung Jung"},"url":"http://localhost:4000/blog/","headline":"Blog","author":{"@type":"Person","name":"Minyoung Jung"},"description":"하루를 정리하는 데일리 로그","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
      <p><span style="font-weight:bolder; font-size:larger;">하루를 정리하는 데일리 로그 </span></p>
      <div style="text-align:center;">
        현재 <strong id="current_date_streak" style="color:#FFC300;">0</strong>일 째 블로깅 중 <br>
        최고 기록:&nbsp;<strong style="color:white;">55</strong>일
      </div>
    <div class="sidebar-personal-info">
      <div class="sidebar-personal-info-section">
        <img src="http://www.gravatar.com/avatar/78abf09c8af4042796ff9379143da32f?s=150" title="View on Gravatar" alt="View on Gravatar" style="margin:auto;"/>
      </div>
      <div class="sidebar-personal-info-section">
        <p>원리를 파악하고 만들고 배우는 것을 좋아합니다. 수영과 클라이밍을 즐깁니다.</p>
      </div>
      
      
      
      <div class="sidebar-personal-info-section">
        <p> Contact:
        
        
        
        <a href="https://github.com/minyoungjung">
          <i class="fa fa-github fa-2x" aria-hidden="true"></i>
        </a>
        
        |
        
        
        
        <a href="minyoungjung84@gmail.com">
          <i class="fa fa-envelope fa-2x" aria-hidden="true"></i>
        </a>
        
        
        
        </p>
      </div>
      
    </div>
  </div>

  <nav class="sidebar-nav">
    
      
      
      

      

      <span class="">
        <a class="sidebar-nav-item " href="/">
          Home
        </a>

        
      </span>

    
      
      
      

      

      <span class="foldable">
        <a class="sidebar-nav-item active" href="/blog/">
          Blog
        </a>

        
          
            
            
            
              <a class="sidebar-nav-item sidebar-nav-item-sub " href="/blog/categories/">
                Categories
              </a>
          
        
          
            
            
            
              <a class="sidebar-nav-item sidebar-nav-item-sub " href="/blog/tags/">
                Tags
              </a>
          
        
      </span>

    
  </nav>

  <div class="sidebar-item">
    <p>
    &copy; 2019 Minyoung Jung.
    </p>
  </div>

</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">

            <a href="/" title="Home" title="Ringsterz Log">
              <img class="masthead-logo" src="/public/logo.png"/>
            </a>
            Log for everything - Day <div style="display:inline"; id="dynamic_day"></div>
          </h3>
        </div>
      </div>



      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/%ED%8C%8C%EC%9D%B4%EC%8D%AC/2019/10/24/codeforce-595/">
        2019-10-24 코드포스 라운드
      </a>
    </h1>

    <span class="post-date">24 Oct 2019</span>
     | 
    
    <a href="/blog/tags/#python" class="post-tag">Python</a>
    
    <a href="/blog/tags/#codeforces" class="post-tag">Codeforces</a>
    
    <a href="/blog/tags/#ps" class="post-tag">PS</a>
    
    

    <article>
      <h2 id="codeforces-라운드-595-div-3">Codeforces 라운드 #595 (Div. 3)</h2>
<p>요즘 알고리즘 인터뷰 하는 것이 대세인지라 PS를 조금 해봤는데, 생각보다 재미있어서 좀더 깊게 파봐야 겠다는 생각을 했다.
대회에만 나오는 알고리즘까지 공부하고 싶진 않지만 문제풀이 자체는 재미있는지라 꾸준히 참여해보려 한다.</p>

<h3 id="1249a">1249A</h3>
<p>조건대로 가면 1 그룹 아니면 2 그룹으로 나뉘어진다. 
정렬하고 차이 1 나는거 있으면 1 아니면 2 출력해서 끝</p>

<h3 id="1249b1">1249B1</h3>
<p>문제에서 요구하는 그대로 코드로 옮겼다.</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tc</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">tc</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">())</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">while</span> <span class="n">pos</span> <span class="o">!=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">ans</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="n">pos</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">print</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">' '</span><span class="p">)</span>
    <span class="k">print</span><span class="p">()</span>
<span class="err"> </span><span class="sb">``</span><span class="err">`</span>

<span class="c1">### 1249B2 ###
</span><span class="err">위</span> <span class="err">문제와</span> <span class="err">같으나</span> <span class="err">쿼리가</span> <span class="mi">1000</span><span class="err">개로</span> <span class="err">증가</span><span class="p">,</span> <span class="n">n</span> <span class="err">의</span> <span class="err">값도</span> <span class="mi">2</span><span class="o">*</span><span class="mi">10</span><span class="o">&lt;</span><span class="n">sup</span><span class="o">&gt;</span><span class="mi">5</span><span class="o">&lt;/</span><span class="n">sup</span><span class="o">&gt;</span><span class="err">으로</span> <span class="err">증가했다</span><span class="o">.</span>
<span class="err">위의</span> <span class="err">방법대로</span> <span class="err">풀면</span> <span class="n">TLE</span><span class="err">가</span> <span class="err">나게</span> <span class="err">되므로</span> <span class="err">최적화</span> <span class="err">할</span> <span class="err">방법을</span> <span class="err">생각해야</span> <span class="err">한다</span><span class="o">.</span>
<span class="err">예제</span> <span class="err">입력인</span>
</code></pre></div></div>
<p>4 6 2 1 5 3</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>의 경우를 살펴보면 첫번째 숫자인 4는  1을 거쳐 다시 4가 되고, 네번째 숫자인 1의 경우엔 4를 거쳤다가 다시 4가 되는 것을 알수 있다.
마찬가지로 두번째 6의 경우는 3 -&gt; 2를 거쳐서 돌아오고, 세번째 2의 경우 6-&gt;3을 거쳐서 자신으로 돌아온다.
이는 자신으로 돌아올때까지 만나는 모든 숫자는 같은 횟수를 가진다는 의미이므로 이를 이용하면 O(N)으로 중복 계산을 없앨 수 있다.

```python
tc = int(input())
for _ in range(tc):
    n = int(input())
    p = list(map(int, input().split()))
    res = [0]*n
    for i in range(n):
        if res[i] == 0:
            ans = 1
            pos = p[i]
            cycle = [i]
            while pos != i+1:
                cycle.append(pos-1)
                ans += 1
                pos = p[pos-1]
            for c in cycle:
                res[c] = ans
    print(*res)
 ```

### 1941C1 ###
### 1941C2 ###
3진법으로 표기했을 때 2가 없으면 그대로 출력하고, 2가 있으면 2가 있는 자리까지는 0으로 바꾸고 자릿수 Carry를 올려주는 방식으로 풀었다.
```python
tc = int(input())
for _ in range(tc):
    n = t = int(input())
    nums = []
    while n:
        nums.append(n % 3)
        n //= 3
    if 2 not in nums:
        print(t)
    else:
        carry = 0
        for i in range(len(nums)):
            nums[i] += carry
            carry = 0
            if nums[i] &gt;= 2:
                for j in range(i + 1):
                    nums[j] = 0
                carry = 1
        if carry:
            nums.append(1)
        ans = 0
        for i in range(len(nums)):
            ans += nums[i] * (3**i)
        print(ans)
</code></pre></div></div>

<h3 id="1249d1">1249D1</h3>
<p>인덱스를 앞에서 부터 조사해 나가다가 겹치는 부분이 k보다 크면 가장 긴 세그먼트를 제거해주면 된다.
입력 크기가 크지 않아 O(N<sup>3</sup>)로 풀어도 된다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">segs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
<span class="n">max_idx</span> <span class="o">=</span> <span class="mi">210</span>
<span class="n">cnt</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">max_idx</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
    <span class="n">segs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
    <span class="n">cnt</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">cnt</span><span class="p">[</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_idx</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">cnt</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cnt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="n">ans</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_idx</span><span class="p">):</span>
    <span class="k">while</span> <span class="n">cnt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">:</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ans</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="ow">and</span> <span class="n">segs</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">segs</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="n">pos</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">segs</span><span class="p">[</span><span class="n">p</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">segs</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">p</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">segs</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">segs</span><span class="p">[</span><span class="n">pos</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">cnt</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">ans</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">print</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">ans</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="p">]))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ans</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s">' '</span><span class="p">)</span>
<span class="err"> </span><span class="sb">``</span><span class="err">`</span>
<span class="err">입력</span> <span class="err">받으면서</span> <span class="err">세그먼트의</span> <span class="err">왼쪽</span> <span class="err">끝</span> <span class="err">부분은</span> <span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="err">오른쪽</span> <span class="err">끝</span> <span class="err">다음</span> <span class="err">칸을</span> <span class="o">-</span><span class="mi">1</span> <span class="err">한</span> <span class="err">후</span> <span class="err">인덱스</span> <span class="err">순서대로</span> <span class="err">숫자를</span> <span class="err">누적시키면</span> <span class="err">세그먼트의</span> <span class="err">누적합을</span> <span class="err">만들</span> <span class="err">수</span> <span class="err">있다</span><span class="o">.</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">3</span> <span class="mi">3</span> <span class="mi">5</span> <span class="mi">2</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span><span class="err">과</span> <span class="err">같은</span> <span class="err">형태가</span> <span class="err">되는데</span> <span class="err">이때</span> <span class="err">하나씩</span> <span class="err">탐색하며</span> <span class="n">k</span><span class="err">보다</span> <span class="err">많이</span> <span class="err">겹친</span> <span class="err">부분을</span> <span class="err">찾으면</span> <span class="err">모든</span> <span class="err">세그먼트를</span> <span class="err">탐색하며</span> <span class="n">k</span><span class="err">에</span> <span class="err">걸친</span> <span class="err">세그먼트</span> <span class="err">인지</span><span class="p">,</span> <span class="err">이미</span> <span class="err">삭제된</span> <span class="err">세그먼트</span> <span class="err">인지</span> <span class="p">(</span><span class="n">ans</span> <span class="err">리스트에</span> <span class="err">체크</span><span class="p">)</span> <span class="err">확인</span> <span class="err">후</span> <span class="err">가장</span> <span class="err">긴</span> <span class="err">세그먼트를</span> <span class="n">pos</span><span class="err">에</span> <span class="err">넣고</span> <span class="err">그</span> <span class="err">세그먼트의</span> <span class="err">누적합을</span> <span class="err">제거한다</span><span class="o">.</span>
<span class="err"> </span>
<span class="c1">### 1249D2 ###
</span><span class="err">위쪽</span> <span class="err">문제와</span> <span class="err">동일하나</span> <span class="err">입력</span> <span class="err">크기가</span> <span class="err">크다</span><span class="o">.</span> <span class="err">세그먼트의</span> <span class="err">왼쪽</span> <span class="err">인덱스를</span> <span class="err">기준으로</span> <span class="err">오른쪽</span> <span class="err">인덱스가</span> <span class="err">가장</span> <span class="err">긴</span> <span class="err">순서로</span> <span class="err">쌓아놓고</span><span class="p">,</span>
<span class="err">인덱스의</span> <span class="err">처음부터</span> <span class="err">순회하며</span> <span class="err">세그먼트가</span> <span class="err">있을때마다</span> <span class="err">추가하고</span><span class="p">,</span> <span class="err">만약</span> <span class="err">세그먼트의</span> <span class="err">중복</span> <span class="err">크기가</span> <span class="n">k</span><span class="err">를</span> <span class="err">넘으면</span> <span class="err">가장</span> <span class="err">오른쪽으로</span> <span class="err">긴</span> <span class="err">세그먼트를</span> <span class="err">제거한다</span><span class="o">.</span> 
<span class="err">가장</span> <span class="err">긴</span> <span class="err">세그먼트를</span> <span class="err">제거해야하므로</span> <span class="err">추가</span> <span class="err">후</span> <span class="err">순서가</span> <span class="err">정렬되어</span> <span class="err">있어야</span> <span class="err">한다</span><span class="o">.</span> 
<span class="err">이</span> <span class="err">부분이</span> <span class="err">가장</span> <span class="err">시간소모가</span> <span class="err">크므로</span>  <span class="n">heap</span><span class="err">을</span> <span class="err">이용해서</span> <span class="err">삽입과</span> <span class="err">동시에</span> <span class="err">정렬이</span> <span class="err">최적화</span> <span class="err">되도록</span> <span class="err">한다</span><span class="o">.</span>

<span class="sb">``</span><span class="err">`</span><span class="n">python</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">heapq</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">n</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">2e5</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ll</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="n">rr</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
<span class="n">vis</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
    <span class="n">ll</span><span class="p">[</span><span class="n">l</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">rr</span><span class="p">[</span><span class="n">r</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">q</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ans</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">ll</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="n">heappush</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
        <span class="n">size</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">while</span> <span class="n">size</span> <span class="o">&gt;</span> <span class="n">k</span><span class="p">:</span>
        <span class="n">cur</span> <span class="o">=</span> <span class="n">heappop</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">vis</span><span class="p">[</span><span class="n">cur</span><span class="p">[</span><span class="mi">1</span><span class="p">]]:</span>
            <span class="n">cur</span> <span class="o">=</span> <span class="n">heappop</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
        <span class="n">vis</span><span class="p">[</span><span class="n">cur</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">ans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cur</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">size</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">rr</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">vis</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span>
            <span class="n">vis</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">size</span> <span class="o">-=</span> <span class="mi">1</span>

<span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ans</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="o">*</span><span class="n">ans</span><span class="p">)</span>
<span class="err"> </span>
</code></pre></div></div>
<p>입력속도가 빠른 stdin으로 입력 받지않으면 그냥 처리하다가 TLE 나므로 주의한다.
입력받을때 세그먼트의 왼쪽 끝 위치의 인덱스에 오른쪽 끝 인덱스와 세그먼트의 순서를 쌍으로 집어넣는다.
이때 -r으로 집어넣어야 나중에 최대값을 꺼낼때 편하다. (Python heap이 기본적으로 min heap이므로..)
이후 입력을 전부 순회하며 heap에 세그먼트를 넣고, 만약 heap의 크기가 k보다 커지면 heap에서 뽑아낸다.
마지막 for 문과 swhile문 안의 while은 현재 조회하는 인덱스가 세그먼트의 오른쪽 끝을 넘었다면 해당 세그먼트를 제거하는 역할을 한다.</p>

<h3 id="1249e">1249E</h3>
<p>간단한 dp 문제
2차원 리스트를 만든 후 이전 상태와 현재 상태의 최소 시간을 비교하면 된다.
dp[0]은 엘레베이터 -&gt; 걷기, 걷기 -&gt; 걷기  중 최소값을 dp[1]은 걷기 -&gt; 엘레베이터, 엘레베이터 -&gt; 엘레베이터 최소값을 저장한다.
이후 dp[0]과 dp[1] 중 최소값을 층별로 출력하면 된다.</p>

<p>```python
n, c = map(int, input().split())
dp = [[0] * n, [0] * n]</p>

<p>a = list(map(int, input().split()))
b = list(map(int, input().split()))</p>

<p>dp[0][0] = 0
dp[1][0] = c
for i in range(n-1):
    dp[0][i + 1] = min(dp[1][i] + a[i], dp[0][i] + a[i])
    dp[1][i + 1] = min(dp[1][i] + b[i], dp[0][i] + b[i] + c)</p>

<p>for i in range(n):
    print(min(dp[0][i], dp[1][i]), end=’ ‘)
 ```</p>

<h3 id="1249f">1249F</h3>
<p>파이썬으로 못풀겠음. 푼 다른 사람도 없다.
PS고급문제 하려면 C++은 필수인듯</p>

    <article>
    <div class="post-more">
      
      <a href="/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/%ED%8C%8C%EC%9D%B4%EC%8D%AC/2019/10/24/codeforce-595/#disqus_thread"> <i class="fa fa-comments" aria-hidden="true"></i>Comment</a>&nbsp;
      
      <a href="/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/%ED%8C%8C%EC%9D%B4%EC%8D%AC/2019/10/24/codeforce-595/"><i class="fa fa-plus-circle" aria-hidden="true"></i>Read more</a>
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/%ED%8C%8C%EC%9D%B4%EC%8D%AC/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/2019/04/09/google-code-jam-2019/">
        Google Code Jam 2019
      </a>
    </h1>

    <span class="post-date">09 Apr 2019</span>
     | 
    
    <a href="/blog/tags/#python" class="post-tag">Python</a>
    
    <a href="/blog/tags/#algorithm" class="post-tag">Algorithm</a>
    
    <a href="/blog/tags/#codejam" class="post-tag">CodeJam</a>
    
    <a href="/blog/tags/#google" class="post-tag">Google</a>
    
    

    <article>
      <h2 id="code-jam-2019">Code Jam 2019</h2>
<p>작년과 마찬가지로 올해도 Code Jam 예선을 참 했다.
예선은 하루종일 진행되어 시간날때 틈틈히 풀면 되서 딱히 부담스럽지 않았다.</p>

<h2 id="예선-문제-리뷰">예선 문제 리뷰</h2>
<p>올해도 파이썬을 이용해 Code Jam에 참여했다.</p>

<h3 id="문제1-foregone-solution-17점">문제1. Foregone Solution (17점)</h3>
<p>4가 들어간 입력을 적절히 분리하여 출력하는 문제였다.
아래와 같이 4를 1과 3이든 2와 2로 분리하든 N = A+B 형태로만 출력하면 되는 문제였다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4     Case #1: 2 2
940   Case #2: 852 88
4444  Case #3: 667 3777

1 ≤ T ≤ 100.
Time limit: 10 seconds per test set.
Memory limit: 1GB.
At least one of the digits of N is a 4.

Test set 1 (Visible)
1 &lt; N &lt; 10^5.

Test set 2 (Visible)
1 &lt; N &lt; 10^9.

Test set 3 (Hidden)
1 &lt; N &lt; 10^100.
</code></pre></div></div>

<p>단순히 첫 문자부터 4를 찾을때마다 2와 2로 나누어주는 식으로 구현했고, AC판정을 받았다.</p>

<h3 id="문제2-you-can-go-your-own-way-24점">문제2. You Can Go Your Own Way (24점)</h3>
<p>미로찾기 문제였는데, 처음 간 사람의 경로를 따라가지 않아야 하는 조건이 붙어있었다.
제일 먼저 떠오른 생각은 그래프로 미로를 표현한 후 BFS로 경로를 탐색하는 것이었는데, 마지막 테스트 셋의 크기가 부담스러웠다.
메모리 제한 및 시간제한에 분명히 걸릴 것 같아서, (안그래도 파이썬으로 풀고있는데..) 다른 방법을 생각해 보았다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Test set 1 (Visible)
2 ≤ N ≤ 10.

Test set 2 (Visible)
2 ≤ N ≤ 1000.

Test set 3 (Hidden)
For at most 10 cases, 2 ≤ N ≤ 50000.
For all other cases, 2 ≤ N ≤ 10000.

1 ≤ T ≤ 100.
Time limit: 15 seconds per test set.
Memory limit: 1GB.
</code></pre></div></div>

<p>어떠한 경로든지 겹치지만 않으면 된다고 해서 단순히 처음 간 사람의 경로를 대칭으로 이동하는 방법으로 구현, AC 판정을 받았다.</p>

<h3 id="문제3-cryptopangrams-25점">문제3. Cryptopangrams (25점)</h3>
<p>알파벳 암호화와 관련된 문제였다. N까지의 소수중 알파벳 갯수만큼 소수를 선택해 작은 순부터 ABCD에 매핑하고,
이후 그 두 수의 곱을 입력으로 주면 그 입력에서 원래의 문자열을 추출하는 문제였다.
문자열에는 ABC..Z가 최소 한번은 포함되어 있다.</p>

<p>A B C D가 3 5 7 11이라 하면, CAD라는 문자열은 7<em>3 3</em>11해서 21 33이 주어지는 식이다</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> 1 ≤ T ≤ 100.
 Time limit: 20 seconds per test set.
 Memory limit: 1 GB.
 25 ≤ L ≤ 100.
 The plaintext contains each English alphabet letter at least once.
 
 Test set 1 (Visible)
 101 ≤ N ≤ 10000.
 
 Test set 2 (Hidden)
 101 ≤ N ≤ 10^100.
</code></pre></div></div>
<p>제일 먼저 든 생각은 암호화 된 숫자들에서 제일 작은 숫자를 골라서 소인수 분해를 해보자는 생각.
 문제는 큰 수에 대한 소인수 분해가 힘들다는것.. 테스트 셋 2를 통과할 가망이 없었다
 그다음으로 생각한 것은 숫자들이 A<em>B, B</em>C, C*D와 같은 형태로 이루어져 있고 나머지 두 수는 소수이니,
 두 수의 공약수를 찾으면 되겠다는 생각.
 공약수야 아무리 큰 수라도 유클리드 호제법을 사용하면 빠르게 찾을 수 있으니, 이걸로 풀면 되겠다는 생각이 들었다.
 그래서 처음에는 두 수의 공약수를 찾아가면서 마지막까지 찾아내고, 처음과 끝에 나머지 글자들을 붙여주게 구현을 했는데 실패.
 다시 생각해보니 최초 하나의 공약수만 찾아낸 후 그걸로 나머지 숫자들을 계속 나누어주면 더 쉽게 풀리는 문제였다.</p>

<p>다시 구현해서 제출하니 또 실패. 정답이라고 생각한 아이디어였는데 계속해서 오답처리가 나니 짜증나서 암호화 문장을 제작하는 프로그램을 작성. TC를 몇개 돌려보니 ABABA와 같은 반복적인 문자열이 나올때, 같은 숫자가 연속되고 최대 공약수가 그냥 그 숫자 자체가 되어버리는 경우가 있다는 것을 발견했다.
 이럴 경우 A~Z가 한번은 나오게 되어있다는 가정을 이용하면, 다른 숫자가 나오는 경우가 반드시 있으므로 이때 최대공약수를 구해서 반대로 값을 메꾸어 나가면 된다. 이를 이용한 코드를 제출하여 AC 판정을 받았다.</p>

<h3 id="문제4-dat-bae-34점">문제4. Dat Bae (34점)</h3>
<p>N개의 컴퓨터 중 고장난 B 대의 컴퓨터를 찾아내는 문제, F번 만큼 쿼리를 날려 응답을 받을수 있다.
TEST_STORE 01101 returns 111.
TEST_STORE 00110 returns 010.
TEST_STORE 01010 returns 100.
TEST_STORE 11010 also returns 100.
0번째 3번째 컴퓨터가 고장났다고 가정했을때의 응답은 위와 같다.</p>

<p>4번은 인터렉션 문제이며 채점 서버에 출력을 날린 후 다시 입력을 받아 그걸 가지고 정답을 찾아내야 한다.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Time limit: 20 seconds per test set.
Memory limit: 1GB.
1 ≤ T ≤ 100.
2 ≤ N ≤ 1024.
1 ≤ B ≤ min(15, N-1).

Test set 1 (Visible)
F = 10.
Test set 2 (Hidden)
F = 5.
</code></pre></div></div>

<p>작년에 새로 등장한 인터렉션 문제는 뭔가 로컬에서 테스트 하는 방법부터가 번거로운 느낌이라 영 적응이 되지 않는다.
사실 문제 4번까지 올 시점이 되면 이미 예선은 통과한 시점이라 파이팅이 좀 떨어지기도 한다. (어렵기도 하고…)
하지만 이번 문제들이 접근만 올바르면 몇 줄 안되는 코드로 풀려버리는 문제들이 많아 흥미로웠고, 마지막까지 도전해보기로 했다.</p>

<p>처음 봤을때 든 생각은 비트마스크를 이용하는 문제인가라는 생각. 
1,2,3번과 마찬가지로 각각의 테스트 셋을 관통하는 풀이를 찾고 싶었는데 쉽게 접근 방법이 떠오르지 않았다.
일단 N의 크기가 2^1에서 2^10라는 점에서 테스트 셋 1의 F=10이 관련이 있겠구나 싶었는데, 
그럼 5번안에는 어떻게 고장난 컴퓨터들을 분별해야 할지 잘 떠오르지 않았다.
고장난 컴퓨터의 수가 min(2^4-1, N-1)이라는 점을 이용할 수 있을 것 같았는데…
결국 해당 문제는 풀지 못했다.</p>

<p>나중에 풀이 접근을 보니
01010…
00110…
00001…
00000…
00000…
00000…
00000…
00000…
00000…
00000…
와 같이 각 10줄의 쿼리에 2진수 0부터 N-1 까지 날려보내면 출력에서 사라진 숫자를 통해 고장난 컴퓨터의 번호를 알수 있다.</p>

<p>문제는 F=5인 경우인데, 5bit으로 표현할 수 있는 크기가 2^5 = 32 뿐이다.
이때 중요한 점은 고장난 컴퓨터의 수가 min(2^4-1, N-1)이므로 고장난 최대 컴퓨터의 수는 15를 넘지 못한다.
이는 5비트 안에 충분히 포함할 수 있는 수이고, 이점을 이용해
01010…010101…10101
00110…001100…10011
00001…000011…01111
00000…000000…11111
00000…111111…11111
0, 1, 2, 3, 4… 16, 17, 18, 19, 20, 21… 27, 28, 29, 30, 31<br />
을 반복해서 날리면, 한 구간이 통제로 소멸될 일이 없으므로 고장난 번호를 알아낼 수 있다.</p>

<h2 id="마치며">마치며</h2>
<p>알고리즘을 손에서 놓지 않기 위해 매년 참가 신청을 했고, 예선 통과라는 소기의 목표도 이미 달성했지만, 1라운드도 참가해야겠다.
부족한 점은 많고 알고리즘은 항상 어렵지만,  아이디어를 통해 문제를 명쾌하게 풀어낼 때의 쾌감이 있다.</p>

    <article>
    <div class="post-more">
      
      <a href="/%ED%8C%8C%EC%9D%B4%EC%8D%AC/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/2019/04/09/google-code-jam-2019/#disqus_thread"> <i class="fa fa-comments" aria-hidden="true"></i>Comment</a>&nbsp;
      
      <a href="/%ED%8C%8C%EC%9D%B4%EC%8D%AC/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/2019/04/09/google-code-jam-2019/"><i class="fa fa-plus-circle" aria-hidden="true"></i>Read more</a>
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/%ED%8C%8C%EC%9D%B4%EC%8D%AC/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/2018/04/11/google-code-jam/">
        Google Code Jam, 그리고 파이썬
      </a>
    </h1>

    <span class="post-date">11 Apr 2018</span>
     | 
    
    <a href="/blog/tags/#python" class="post-tag">Python</a>
    
    <a href="/blog/tags/#algorithm" class="post-tag">Algorithm</a>
    
    <a href="/blog/tags/#codejam" class="post-tag">CodeJam</a>
    
    <a href="/blog/tags/#google" class="post-tag">Google</a>
    
    <a href="/blog/tags/#jekyll" class="post-tag">Jekyll</a>
    
    

    <article>
      <p>오랜만에 블로그를 쓴다.</p>

<h2 id="알고리즘-code-jam">알고리즘, Code Jam</h2>
<p>알고리즘과 그리 친하지는 않지만, 아예 손을 놓지 않으려고 매년 Google Code Jam에 참가 신청을 한다.
매년 예선만 통과하자라는 생각으로 크게 욕심부리지 않고 있는데, 다행히 매번 예선은 통과했었다.
작년부터는 파이썬에 좀더 익숙해지기 위해서 파이썬을 이용해서 문제들을 풀고 있다.</p>

<h2 id="code-jam-2018-그리고-파이썬">Code Jam 2018, 그리고 파이썬</h2>
<p>참가신청만 해놓고 완전히 잊고있다가, 주말에 늦잠자다 일어나서 컴퓨터를 켜보니까 메일이 와있다.
<img src="/post_assets/2018-04-11/codejam_6hour.png" alt="6hours left" />
말이 여섯시간이지… 나는 아침까지 자느라 2시간도 채 안남았다고…
그래도 예선 통과를 위한 점수를 맞추기는 할만할것 같아서 Code Jam 사이트에 접속!</p>

<p>분명 작년까지는 small input과 large input의 데이터셋에 각각 프로그램을 돌리고,
output 파일을 제출했던 Code jam 형태가 갑자기 online judge 형태로 바뀌었다. 
코드도 페이지 상에서 작성하여 바로 제출할 수 있는 형태로 바뀌었고, 따로 입력 데이터가 주어지지 않는다.
그리고 테스트 파일을 다운받을 수 있는 뭔가 새로운 양식의 문제도 하나 끼어있는 것 같다.
그리고 judge가 버벅이는지 이에 대한 안내 문구까지 출력되고…</p>

<p>그래도 문제를 둘러보니 1, 2번만 풀면 38점으로 예선을 통과할 수 있을 것 같다.
다행히 시간내에 1, 2번을 다 풀고, 결과를 확인하는데..
2번의 15점 배점 문제가 TIME_LIMIT_EXCEEDED가 나서 실패했다.</p>

<p>쉽다고 생각한 문제에서 틀린 이후 제일 먼저 든 생각은 Python의 느린 입출력 때문이 아닐까라는 생각이 들었다.
<code class="highlighter-rouge">input()</code> 대신 <code class="highlighter-rouge">sys.stdin.readline()</code>을 썼어야 하나 등등…
작년까지는 로컬에서 아웃풋 파일을 만들어서 업로드를 하면 되는 형식이라, 
입출력 속도에 민감하게 신경쓰지 않았기도 하고, 코드가 돌아가서 결과만 나오면 된다는 생각이었으니 말이지.</p>

<p>라운드가 끝난 이후 Analysis를 살펴보고 실제로는 내 구현상의 문제였다는 것을 알게되었다.
‘시간초과가 난 것은 파이썬이 느리기 때문이다.’라고 생각한 내 자신이 민망하기도 하고,
결과적으로는 처음으로 예선 라운드에 떨어지게 되었지만 오히려 더 배운것은 많았던 Code Jam이었다.</p>

<h2 id="그리고-jekyll">그리고 jekyll</h2>
<p>작년 12월 경 MacOS가 High Sierra로 업데이트 되면서 Ruby 2.0이 지원되지 않게 되었다.
덕분에 Ruby Gem으로 이루어진 Jekyll 또한 먹통이 되었다.
(한동안 블로깅을 멀리한 탓에 내가 jekyll 사용법을 까먹은 줄 알았다…)</p>

<p>jekyll을 다시 사용하려면 거쳐야 할 방법에 대해서는 아래 링크 참조..
<a href="[https://github.com/jekyll/jekyll/issues/6637]">https://github.com/jekyll/jekyll/issues/6637</a></p>


    <article>
    <div class="post-more">
      
      <a href="/%ED%8C%8C%EC%9D%B4%EC%8D%AC/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/2018/04/11/google-code-jam/#disqus_thread"> <i class="fa fa-comments" aria-hidden="true"></i>Comment</a>&nbsp;
      
      <a href="/%ED%8C%8C%EC%9D%B4%EC%8D%AC/%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/2018/04/11/google-code-jam/"><i class="fa fa-plus-circle" aria-hidden="true"></i>Read more</a>
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/%EC%95%88%EB%93%9C%EB%A1%9C%EC%9D%B4%EB%93%9C/2017/07/24/firebase-database-usage/">
        Firebase로 동기화되는 Database 사용하기
      </a>
    </h1>

    <span class="post-date">24 Jul 2017</span>
     | 
    
    <a href="/blog/tags/#android" class="post-tag">Android</a>
    
    <a href="/blog/tags/#java" class="post-tag">Java</a>
    
    <a href="/blog/tags/#firebase" class="post-tag">Firebase</a>
    
    

    <article>
      <h2 id="firebase-프로젝트-추가">firebase 프로젝트 추가</h2>
<p><a href="https://console.firebase.google.com">https://console.firebase.google.com</a>에서 프로젝트 추가
<img src="/post_assets/2017-07-23/add_done.png" alt="프로젝트 추가" /></p>

<h2 id="firebase-안드로이드-추가">firebase 안드로이드 추가</h2>
<p><img src="/post_assets/2017-07-23/firebase_add.png" alt="안드로이드 추가" /></p>

<h2 id="google-servicesjson-추가">google-services.json 추가</h2>
<p><code class="highlighter-rouge">google-services.json</code> 파일을 app 영역의 root에 집어넣음. (project 보기)</p>

<h2 id="buildgradle-변경">build.gradle 변경</h2>

<p>build.gradle(project)에 다음 추가</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dependencies</span> <span class="o">{</span>
    <span class="n">classpath</span> <span class="err">'</span><span class="n">com</span><span class="o">.</span><span class="na">google</span><span class="o">.</span><span class="na">gms</span><span class="o">:</span><span class="n">google</span><span class="o">-</span><span class="nl">services:</span><span class="mf">3.1</span><span class="o">.</span><span class="mi">0</span><span class="err">'</span>
<span class="o">}</span>
</code></pre></div></div>

<p>build.gradle(app) 마지막줄에 다음 줄 추가</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">apply</span> <span class="nl">plugin:</span> <span class="err">'</span><span class="n">com</span><span class="o">.</span><span class="na">google</span><span class="o">.</span><span class="na">gms</span><span class="o">.</span><span class="na">google</span><span class="o">-</span><span class="n">services</span><span class="err">'</span>
</code></pre></div></div>

<p>build.gradle(app)의 dependency에 다음 추가 (database 및 recyclerView 이용을 위한 라이브러리)</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">compile</span> <span class="err">'</span><span class="n">com</span><span class="o">.</span><span class="na">google</span><span class="o">.</span><span class="na">firebase</span><span class="o">:</span><span class="n">firebase</span><span class="o">-</span><span class="nl">database:</span><span class="mf">11.0</span><span class="o">.</span><span class="mi">2</span><span class="err">'</span>
<span class="n">compile</span> <span class="err">'</span><span class="n">com</span><span class="o">.</span><span class="na">firebaseui</span><span class="o">:</span><span class="n">firebase</span><span class="o">-</span><span class="n">ui</span><span class="o">-</span><span class="nl">database:</span><span class="mf">0.5</span><span class="o">.</span><span class="mi">3</span><span class="err">'</span>
</code></pre></div></div>

<p>이후 프로젝트 sync</p>

<h2 id="model-추가">Model 추가</h2>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Notice</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">subject</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">content</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Notice</span><span class="o">(){</span>

    <span class="o">};</span>

    <span class="kd">public</span> <span class="nf">Notice</span><span class="o">(</span><span class="n">String</span> <span class="n">subject</span><span class="o">,</span> <span class="n">String</span> <span class="n">content</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">subject</span> <span class="o">=</span> <span class="n">subject</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">content</span> <span class="o">=</span> <span class="n">content</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getSubject</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">subject</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSubject</span><span class="o">(</span><span class="n">String</span> <span class="n">subject</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">subject</span> <span class="o">=</span> <span class="n">subject</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getContent</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">content</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setContent</span><span class="o">(</span><span class="n">String</span> <span class="n">content</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">content</span> <span class="o">=</span> <span class="n">content</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="recyclerview-item-layout-추가">RecyclerView item layout 추가</h2>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;LinearLayout</span> <span class="na">xmlns:android=</span><span class="s">"http://schemas.android.com/apk/res/android"</span>
    <span class="na">android:layout_width=</span><span class="s">"wrap_content"</span>
    <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
    <span class="na">android:orientation=</span><span class="s">"horizontal"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;TextView</span>
        <span class="na">android:id=</span><span class="s">"@+id/subjectTextView"</span>
        <span class="na">android:layout_width=</span><span class="s">"wrap_content"</span>
        <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
        <span class="na">android:layout_margin=</span><span class="s">"@dimen/text_margin"</span>
        <span class="na">android:textAppearance=</span><span class="s">"?attr/textAppearanceListItem"</span> <span class="nt">/&gt;</span>

    <span class="nt">&lt;TextView</span>
        <span class="na">android:id=</span><span class="s">"@+id/contentTextView"</span>
        <span class="na">android:layout_width=</span><span class="s">"wrap_content"</span>
        <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
        <span class="na">android:layout_margin=</span><span class="s">"@dimen/text_margin"</span>
        <span class="na">android:textAppearance=</span><span class="s">"?attr/textAppearanceListItem"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/LinearLayout&gt;</span>

</code></pre></div></div>

<h2 id="recyclerview-layout-추가">RecyclerView layout 추가</h2>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;android.support.v7.widget.RecyclerView</span> <span class="na">xmlns:android=</span><span class="s">"http://schemas.android.com/apk/res/android"</span>
    <span class="na">xmlns:app=</span><span class="s">"http://schemas.android.com/apk/res-auto"</span>
    <span class="na">xmlns:tools=</span><span class="s">"http://schemas.android.com/tools"</span>
    <span class="na">android:id=</span><span class="s">"@+id/noticelist"</span>
    <span class="na">android:name=</span><span class="s">"com.ringsterz.picmemo.fragment.ItemFragment"</span>
    <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
    <span class="na">android:layout_height=</span><span class="s">"match_parent"</span>
    <span class="na">android:layout_marginLeft=</span><span class="s">"16dp"</span>
    <span class="na">android:layout_marginRight=</span><span class="s">"16dp"</span>
    <span class="na">app:layoutManager=</span><span class="s">"LinearLayoutManager"</span>
    <span class="na">tools:context=</span><span class="s">"com.ringsterz.picmemo.fragment.NotificationFragment"</span>
    <span class="na">tools:listitem=</span><span class="s">"@layout/fragment_item"</span> <span class="nt">/&gt;</span>
</code></pre></div></div>

<h2 id="변수-선언-및-viewholder-정의-프래그먼트나-엑티비티의-inner-class로-추가">변수 선언 및 viewHolder 정의 (프래그먼트나 엑티비티의 inner class로 추가)</h2>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="n">DatabaseReference</span> <span class="n">mFirebaseDatabaseReference</span><span class="o">;</span>
<span class="kd">private</span> <span class="n">FirebaseRecyclerAdapter</span><span class="o">&lt;</span><span class="n">Notice</span><span class="o">,</span> <span class="n">MessageViewHolder</span><span class="o">&gt;</span> <span class="n">mFirebaseAdapter</span><span class="o">;</span>
<span class="kd">private</span> <span class="n">LinearLayoutManager</span> <span class="n">mLayoutManager</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">MessageViewHolder</span> <span class="kd">extends</span> <span class="n">RecyclerView</span><span class="o">.</span><span class="na">ViewHolder</span> <span class="o">{</span>
    <span class="n">TextView</span> <span class="n">subjectTextView</span><span class="o">;</span>
    <span class="n">TextView</span> <span class="n">contentTextView</span><span class="o">;</span>

<span class="kd">public</span> <span class="nf">MessageViewHolder</span><span class="o">(</span><span class="n">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
    <span class="kd">super</span><span class="o">(</span><span class="n">v</span><span class="o">);</span>
    <span class="n">subjectTextView</span> <span class="o">=</span> <span class="n">itemView</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">subjectTextView</span><span class="o">);</span>
    <span class="n">contentTextView</span> <span class="o">=</span> <span class="n">itemView</span><span class="o">.</span><span class="na">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">contentTextView</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h2 id="recyclerview와-adapter-설정-및-observer-설정-fragment">RecyclerView와 adapter 설정 및 observer 설정 (Fragment)</h2>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Override</span>
<span class="kd">public</span> <span class="n">View</span> <span class="nf">onCreateView</span><span class="o">(</span><span class="n">LayoutInflater</span> <span class="n">inflater</span><span class="o">,</span> <span class="n">ViewGroup</span> <span class="n">container</span><span class="o">,</span>
<span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
<span class="n">View</span> <span class="n">view</span> <span class="o">=</span> <span class="n">inflater</span><span class="o">.</span><span class="na">inflate</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">fragment_item_list</span><span class="o">,</span> <span class="n">container</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>

<span class="c1">// Set the adapter</span>
<span class="k">if</span> <span class="o">(</span><span class="n">view</span> <span class="k">instanceof</span> <span class="n">RecyclerView</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Context</span> <span class="n">context</span> <span class="o">=</span> <span class="n">view</span><span class="o">.</span><span class="na">getContext</span><span class="o">();</span>
    <span class="n">recyclerView</span> <span class="o">=</span> <span class="o">(</span><span class="n">RecyclerView</span><span class="o">)</span> <span class="n">view</span><span class="o">;</span>
    <span class="n">mLayoutManager</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LinearLayoutManager</span><span class="o">(</span><span class="n">context</span><span class="o">);</span>
    <span class="n">recyclerView</span><span class="o">.</span><span class="na">setLayoutManager</span><span class="o">(</span><span class="n">mLayoutManager</span><span class="o">);</span>

    <span class="c1">// New child entries</span>
    <span class="n">mFirebaseDatabaseReference</span> <span class="o">=</span> <span class="n">FirebaseDatabase</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">getReference</span><span class="o">();</span>
    <span class="n">mFirebaseAdapter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FirebaseRecyclerAdapter</span><span class="o">&lt;</span><span class="n">Notice</span><span class="o">,</span>
        <span class="n">MessageViewHolder</span><span class="o">&gt;(</span>
        <span class="n">Notice</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
        <span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">fragment_item</span><span class="o">,</span>
        <span class="n">MessageViewHolder</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
        <span class="n">mFirebaseDatabaseReference</span><span class="o">.</span><span class="na">child</span><span class="o">(</span><span class="s">"notification"</span><span class="o">))</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">populateViewHolder</span><span class="o">(</span><span class="kd">final</span> <span class="n">MessageViewHolder</span> <span class="n">viewHolder</span><span class="o">,</span>
                                    <span class="n">Notice</span> <span class="n">notice</span><span class="o">,</span> <span class="kt">int</span> <span class="n">position</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">notice</span><span class="o">.</span><span class="na">getSubject</span><span class="o">()</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">viewHolder</span><span class="o">.</span><span class="na">subjectTextView</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">notice</span><span class="o">.</span><span class="na">getSubject</span><span class="o">());</span>
        <span class="n">viewHolder</span><span class="o">.</span><span class="na">contentTextView</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">notice</span><span class="o">.</span><span class="na">getContent</span><span class="o">());</span>
        <span class="o">}</span>

    <span class="o">}</span>
<span class="o">};</span>

<span class="n">mFirebaseAdapter</span><span class="o">.</span><span class="na">registerAdapterDataObserver</span><span class="o">(</span><span class="k">new</span> <span class="n">RecyclerView</span><span class="o">.</span><span class="na">AdapterDataObserver</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onItemRangeInserted</span><span class="o">(</span><span class="kt">int</span> <span class="n">positionStart</span><span class="o">,</span> <span class="kt">int</span> <span class="n">itemCount</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onItemRangeInserted</span><span class="o">(</span><span class="n">positionStart</span><span class="o">,</span> <span class="n">itemCount</span><span class="o">);</span>
        <span class="kt">int</span> <span class="n">noticeCount</span> <span class="o">=</span> <span class="n">mFirebaseAdapter</span><span class="o">.</span><span class="na">getItemCount</span><span class="o">();</span>
        <span class="kt">int</span> <span class="n">lastVisiblePosition</span> <span class="o">=</span>
            <span class="n">mLayoutManager</span><span class="o">.</span><span class="na">findLastCompletelyVisibleItemPosition</span><span class="o">();</span>
        <span class="c1">// If the recycler view is initially being loaded or the</span>
        <span class="c1">// user is at the bottom of the list, scroll to the bottom</span>
        <span class="c1">// of the list to show the newly added message.</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">lastVisiblePosition</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">||</span>
            <span class="o">(</span><span class="n">positionStart</span> <span class="o">&gt;=</span> <span class="o">(</span><span class="n">noticeCount</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&amp;&amp;</span>
                <span class="n">lastVisiblePosition</span> <span class="o">==</span> <span class="o">(</span><span class="n">positionStart</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)))</span> <span class="o">{</span>
            <span class="n">recyclerView</span><span class="o">.</span><span class="na">scrollToPosition</span><span class="o">(</span><span class="n">positionStart</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>   
<span class="o">});</span>

<span class="n">recyclerView</span><span class="o">.</span><span class="na">setAdapter</span><span class="o">(</span><span class="n">mFirebaseAdapter</span><span class="o">);</span>

<span class="o">}</span>

<span class="k">return</span> <span class="n">view</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="rule-설정">Rule 설정</h2>
<p>인증하지 않고 데이터를 받으려면 Firebase console에서 아래와 같이 읽기 권한을 준다.</p>
<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="s2">"rules"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">".read"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">".write"</span><span class="p">:</span><span class="w"> </span><span class="s2">"auth != null"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="firebase-data-형태">Firebase Data 형태</h2>
<p><img src="/post_assets/2017-07-24/data.png" alt="Data형태" />
위와 같이 db 밑에 child명을 주고 임의의 인스턴스 값 하위에 model에서 정의한 값을 넣어주면 된다.</p>

<h2 id="동기화-결과">동기화 결과</h2>
<p><img src="/post_assets/2017-07-24/result.png" alt="Result" />
DB에서 값을 바꿀 경우 바로 동기화되어 view에 반영된다.</p>


    <article>
    <div class="post-more">
      
      <a href="/%EC%95%88%EB%93%9C%EB%A1%9C%EC%9D%B4%EB%93%9C/2017/07/24/firebase-database-usage/#disqus_thread"> <i class="fa fa-comments" aria-hidden="true"></i>Comment</a>&nbsp;
      
      <a href="/%EC%95%88%EB%93%9C%EB%A1%9C%EC%9D%B4%EB%93%9C/2017/07/24/firebase-database-usage/"><i class="fa fa-plus-circle" aria-hidden="true"></i>Read more</a>
    </div>
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/%EC%95%88%EB%93%9C%EB%A1%9C%EC%9D%B4%EB%93%9C/2017/07/23/firebase-notification-usage/">
        Firebase 사용하여 Notification 보내기
      </a>
    </h1>

    <span class="post-date">23 Jul 2017</span>
     | 
    
    <a href="/blog/tags/#android" class="post-tag">Android</a>
    
    <a href="/blog/tags/#java" class="post-tag">Java</a>
    
    <a href="/blog/tags/#firebase" class="post-tag">Firebase</a>
    
    

    <article>
      <h2 id="firebase-프로젝트-추가">firebase 프로젝트 추가</h2>
<p><a href="https://console.firebase.google.com">https://console.firebase.google.com</a>에서 프로젝트 추가
<img src="/post_assets/2017-07-23/add_done.png" alt="프로젝트 추가" /></p>

<h2 id="firebase-안드로이드-추가">firebase 안드로이드 추가</h2>
<p><img src="/post_assets/2017-07-23/firebase_add.png" alt="안드로이드 추가" /></p>

<h2 id="google-servicesjson-추가">google-services.json 추가</h2>
<p><code class="highlighter-rouge">google-services.json</code> 파일을 app 영역의 root에 집어넣음. (project 보기)</p>

<h2 id="buildgradle-변경">build.gradle 변경</h2>

<p>build.gradle(project)에 다음 추가</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">dependencies</span> <span class="o">{</span>
    <span class="n">classpath</span> <span class="err">'</span><span class="n">com</span><span class="o">.</span><span class="na">google</span><span class="o">.</span><span class="na">gms</span><span class="o">:</span><span class="n">google</span><span class="o">-</span><span class="nl">services:</span><span class="mf">3.1</span><span class="o">.</span><span class="mi">0</span><span class="err">'</span>
<span class="o">}</span>
</code></pre></div></div>

<p>build.gradle(app) 마지막줄에 다음 줄 추가</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">apply</span> <span class="nl">plugin:</span> <span class="err">'</span><span class="n">com</span><span class="o">.</span><span class="na">google</span><span class="o">.</span><span class="na">gms</span><span class="o">.</span><span class="na">google</span><span class="o">-</span><span class="n">services</span><span class="err">'</span>
</code></pre></div></div>

<p>build.gradle(app)의 dependency에 다음 추가 (Notification 사용 라이브러리)</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">compile</span> <span class="err">'</span><span class="n">com</span><span class="o">.</span><span class="na">google</span><span class="o">.</span><span class="na">firebase</span><span class="o">:</span><span class="n">firebase</span><span class="o">-</span><span class="nl">core:</span><span class="mf">11.0</span><span class="o">.</span><span class="mi">2</span><span class="err">'</span>
<span class="n">compile</span> <span class="err">'</span><span class="n">com</span><span class="o">.</span><span class="na">google</span><span class="o">.</span><span class="na">firebase</span><span class="o">:</span><span class="n">firebase</span><span class="o">-</span><span class="nl">messaging:</span><span class="mf">11.0</span><span class="o">.</span><span class="mi">2</span><span class="err">'</span>
</code></pre></div></div>

<p>이후 프로젝트 sync</p>

<h2 id="firebasemessagingservice-추가">FirebaseMessagingService 추가</h2>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyFirebaseMessagingService</span> <span class="kd">extends</span> <span class="n">FirebaseMessagingService</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">TAG</span> <span class="o">=</span> <span class="s">"FCM Service"</span><span class="o">;</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onMessageReceived</span><span class="o">(</span><span class="n">RemoteMessage</span> <span class="n">remoteMessage</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">"From: "</span> <span class="o">+</span> <span class="n">remoteMessage</span><span class="o">.</span><span class="na">getFrom</span><span class="o">());</span>
        <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">"Notification Message Body: "</span> <span class="o">+</span> <span class="n">remoteMessage</span><span class="o">.</span><span class="na">getNotification</span><span class="o">().</span><span class="na">getBody</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="firebaseinstanceidservice-추가">FirebaseInstanceIdService 추가</h2>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">FirebaseIDService</span> <span class="kd">extends</span> <span class="n">FirebaseInstanceIdService</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">TAG</span> <span class="o">=</span> <span class="s">"FirebaseIDService"</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onTokenRefresh</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// Get updated InstanceID token.</span>
        <span class="n">String</span> <span class="n">refreshedToken</span> <span class="o">=</span> <span class="n">FirebaseInstanceId</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">getToken</span><span class="o">();</span>
        <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">"Refreshed token: "</span> <span class="o">+</span> <span class="n">refreshedToken</span><span class="o">);</span>

        <span class="c1">// TODO: Implement this method to send any registration to your app's servers.</span>
        <span class="n">sendRegistrationToServer</span><span class="o">(</span><span class="n">refreshedToken</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">sendRegistrationToServer</span><span class="o">(</span><span class="n">String</span> <span class="n">token</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Add custom implementation, as needed.</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="매니페스트에-서비스-추가">매니페스트에 서비스 추가</h2>
<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nt">&lt;service</span> <span class="na">android:name=</span><span class="s">".service.MyFirebaseMessagingService"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"com.google.firebase.MESSAGING_EVENT"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/service&gt;</span>

<span class="nt">&lt;service</span> <span class="na">android:name=</span><span class="s">".service.FirebaseIDService"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"com.google.firebase.INSTANCE_ID_EVENT"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/service&gt;</span>
</code></pre></div></div>
<p>서비스 태그는 애플리케이션 태그 속에 넣으면 된다.</p>

<h2 id="notification-보내기">Notification 보내기</h2>
<p><img src="/post_assets/2017-07-23/noti_send.png" alt="알림 보내기" />
콘솔에서 앱 전체를 대상으로 Notification를 보낸 모습</p>

<h2 id="notification-전송-모습">Notification 전송 모습</h2>
<p>상태창을 보면 notification이 전송된 것을 볼 수 있다.
<img src="/post_assets/2017-07-23/noti_bg.png" alt="백그라운드 알림" /></p>

<p>앱이 떠있을때는 로그로 정상 출력되는 것을 볼 수 있다.
<img src="/post_assets/2017-07-23/noti_sent.png" alt="포그라운드 알림" /></p>


    <article>
    <div class="post-more">
      
      <a href="/%EC%95%88%EB%93%9C%EB%A1%9C%EC%9D%B4%EB%93%9C/2017/07/23/firebase-notification-usage/#disqus_thread"> <i class="fa fa-comments" aria-hidden="true"></i>Comment</a>&nbsp;
      
      <a href="/%EC%95%88%EB%93%9C%EB%A1%9C%EC%9D%B4%EB%93%9C/2017/07/23/firebase-notification-usage/"><i class="fa fa-plus-circle" aria-hidden="true"></i>Read more</a>
    </div>
  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/blog/page2">Older</a>
  
  
    <span class="pagination-item newer">Newer</span>
  
</div>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if (target === toggle) {
            checkbox.checked = !checkbox.checked;
            e.preventDefault();
          } else if (checkbox.checked && !sidebar.contains(target)) {
            /* click outside the sidebar when sidebar is open */
            checkbox.checked = false;
          }
        }, false);
      })(document);
    </script>
    
    <script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-67856795-3', 'auto');
ga('send', 'pageview');
    </script>
    
  </body>
  
  <script id="dsq-count-scr" src="//ringsterz.disqus.com/count.js" async></script>
  

  <!--Import jQuery -->
  <script type="text/javascript" src="https://code.jquery.com/jquery-latest.min.js"></script>

  <script>
    // Calculate total_blogging_date_dynamically
    $(document).ready(function() {
      var date_str = "2017-05-31 00:00:00 +0900"; // 2017-05-31 00:00:00 +0900
      var today = new Date()
      today.setHours(0,0,0,0)
      var firstday = new Date(date_str.split(' ')[0])
      firstday.setHours(0,0,0,0)
      var total_date = ((today-firstday) / 86400000)+1; // calc datediff
      $("#dynamic_day").text(total_date);
    });

    // Calculate current_date_streak dynamically
    $(document).ready(function(){
      var latest_post_date_str = "2019-10-24 00:00:00 +0900";
      var day_passed = Math.floor((Date.now() - Date.parse(latest_post_date_str.split(' ')[0])) / 86400000);
      // if latest posting date passed a day then reset to 0
      if (day_passed > 1) {
        $("#current_date_streak").text("0");
      }
    });
  </script>
</html>
